/*
 * Retina.js v1.1.0
 *
 * Copyright 2013 Imulus, LLC
 * Released under the MIT license
 *
 * Retina.js is an open source script that makes it easy to serve
 * high-resolution images to devices with retina displays.
 */
(function(){var e=typeof exports=="undefined"?window:exports;var a={check_mime_type:true};e.Retina=b;function b(){}b.configure=function(f){if(f==null){f={}}for(var g in f){a[g]=f[g]}};b.init=function(f){if(f==null){f=e}var g=f.onload||new Function;f.onload=function(){var k=document.getElementsByTagName("img"),l=[],h,j;for(h=0;h<k.length;h++){j=k[h];l.push(new c(j))}g()}};b.isRetina=function(){var f="(-webkit-min-device-pixel-ratio: 1.5),                      (min--moz-device-pixel-ratio: 1.5),                      (-o-min-device-pixel-ratio: 3/2),                      (min-resolution: 1.5dppx)";if(e.devicePixelRatio>1){return true}if(e.matchMedia&&e.matchMedia(f).matches){return true}return false};e.RetinaImagePath=d;function d(g,f){this.path=g;if(typeof f!=="undefined"&&f!==null){this.at_2x_path=f;this.perform_check=false}else{this.at_2x_path=g.replace(/\.\w+$/,function(h){return"@2x"+h});this.perform_check=true}}d.confirmed_paths=[];d.prototype.is_external=function(){return !!(this.path.match(/^https?\:/i)&&!this.path.match("//"+document.domain))};d.prototype.check_2x_variant=function(f){var g,h=this;if(this.is_external()){return f(false)}else{if(!this.perform_check&&typeof this.at_2x_path!=="undefined"&&this.at_2x_path!==null){return f(true)}else{if(this.at_2x_path in d.confirmed_paths){return f(true)}else{g=new XMLHttpRequest;g.open("HEAD.html",this.at_2x_path);g.onreadystatechange=function(){if(g.readyState!=4){return f(false)}if(g.status>=200&&g.status<=399){if(a.check_mime_type){var i=g.getResponseHeader("Content-Type");if(i==null||!i.match(/^image/i)){return f(false)}}d.confirmed_paths.push(h.at_2x_path);return f(true)}else{return f(false)}};g.send()}}}};function c(f){this.el=f;this.path=new d(this.el.getAttribute("src"),this.el.getAttribute("data-at2x"));var g=this;this.path.check_2x_variant(function(h){if(h){g.swap()}})}e.RetinaImage=c;c.prototype.swap=function(g){if(typeof g=="undefined"){g=this.path.at_2x_path}var h=this;function f(){if(!h.el.complete){setTimeout(f,5)}else{h.el.setAttribute("width",h.el.offsetWidth);h.el.setAttribute("height",h.el.offsetHeight);h.el.setAttribute("src",g)}}f()};if(b.isRetina()){b.init(e)}})();